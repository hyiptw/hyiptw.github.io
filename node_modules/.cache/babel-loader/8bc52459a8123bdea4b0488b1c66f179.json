{"ast":null,"code":"import _regeneratorRuntime from\"/home/fs/srmswap/srmswap/srmswap.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/fs/srmswap/srmswap/srmswap.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/fs/srmswap/srmswap/srmswap.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useContext,useEffect,useState}from\"react\";import{calculateDependentAmount,usePoolForBasket}from\"./pools\";import{useMint,useAccountByMint}from\"./accounts\";import{useConnection,useConnectionConfig}from\"./connection\";import{convert}from\"./utils\";import PopularTokens from\"../utils/token-list.json\";import{useHistory,useLocation}from\"react-router-dom\";var CurrencyPairContext=React.createContext(null);export function CurrencyPairProvider(_ref){var _ref$children=_ref.children,children=_ref$children===void 0?null:_ref$children;var connection=useConnection();var _useConnectionConfig=useConnectionConfig(),env=_useConnectionConfig.env;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),amountA=_useState2[0],setAmountA=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),amountB=_useState4[0],setAmountB=_useState4[1];var history=useHistory();var location=useLocation();var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),mintAddressA=_useState6[0],setMintAddressA=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),mintAddressB=_useState8[0],setMintAddressB=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),lastTypedAccount=_useState10[0],setLastTypedAccount=_useState10[1];var accountA=useAccountByMint(mintAddressA);var accountB=useAccountByMint(mintAddressB);var mintA=useMint(mintAddressA);var mintB=useMint(mintAddressB);var pool=usePoolForBasket([mintAddressA,mintAddressB]);// updates browser history on token changes\nuseEffect(function(){var _PopularTokens$env$fi,_PopularTokens$env$fi2;// set history\nvar base=(_PopularTokens$env$fi=PopularTokens[env].find(function(t){return t.mintAddress===mintAddressA;}))===null||_PopularTokens$env$fi===void 0?void 0:_PopularTokens$env$fi.tokenSymbol;var quote=(_PopularTokens$env$fi2=PopularTokens[env].find(function(t){return t.mintAddress===mintAddressB;}))===null||_PopularTokens$env$fi2===void 0?void 0:_PopularTokens$env$fi2.tokenSymbol;if(base&&quote){history.push({pathname:\"/\",search:\"?pair=\".concat(base,\"-\").concat(quote)});}else{if(mintAddressA&&mintAddressB){history.push({pathname:\"/\",search:\"\"});}else{history.push({});}}},[mintAddressA,mintAddressB]);// Updates tokens on location change\nuseEffect(function(){var _PopularTokens$env$fi3,_PopularTokens$env$fi4;if(!location.search&&mintAddressA&&mintAddressB){return;}var _getDefaultTokens=getDefaultTokens(env,location.search),defaultBase=_getDefaultTokens.defaultBase,defaultQuote=_getDefaultTokens.defaultQuote;setMintAddressA(((_PopularTokens$env$fi3=PopularTokens[env].find(function(t){return t.tokenSymbol===defaultBase;}))===null||_PopularTokens$env$fi3===void 0?void 0:_PopularTokens$env$fi3.mintAddress)||\"\");setMintAddressB(((_PopularTokens$env$fi4=PopularTokens[env].find(function(t){return t.tokenSymbol===defaultQuote;}))===null||_PopularTokens$env$fi4===void 0?void 0:_PopularTokens$env$fi4.mintAddress)||\"\");},[location,location.search,setMintAddressA,setMintAddressB]);var calculateDependent=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var setDependent,amount,independent,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(pool&&mintAddressA&&mintAddressB)){_context.next=6;break;}if(lastTypedAccount===mintAddressA){independent=mintAddressA;setDependent=setAmountB;amount=parseFloat(amountA);}else{independent=mintAddressB;setDependent=setAmountA;amount=parseFloat(amountB);}_context.next=4;return calculateDependentAmount(connection,independent,amount,pool);case 4:result=_context.sent;if(result!==undefined&&Number.isFinite(result)){setDependent(result.toFixed(2));}else{setDependent(\"\");}case 6:case\"end\":return _context.stop();}}},_callee);})),[pool,mintAddressA,mintAddressB,setAmountA,setAmountB,amountA,amountB,connection,lastTypedAccount]);useEffect(function(){calculateDependent();},[amountB,amountA,lastTypedAccount,calculateDependent]);var _convertAmount=function convertAmount(amount,mint){return parseFloat(amount)*Math.pow(10,(mint===null||mint===void 0?void 0:mint.decimals)||0);};return/*#__PURE__*/React.createElement(CurrencyPairContext.Provider,{value:{A:{mintAddress:mintAddressA,account:accountA,mint:mintA,amount:amountA,setAmount:setAmountA,setMint:setMintAddressA,convertAmount:function convertAmount(){return _convertAmount(amountA,mintA);},sufficientBalance:function sufficientBalance(){return accountA!==undefined&&convert(accountA,mintA)>=parseFloat(amountA);}},B:{mintAddress:mintAddressB,account:accountB,mint:mintB,amount:amountB,setAmount:setAmountB,setMint:setMintAddressB,convertAmount:function convertAmount(){return _convertAmount(amountB,mintB);},sufficientBalance:function sufficientBalance(){return accountB!==undefined&&convert(accountB,mintB)>=parseFloat(amountB);}},setLastTypedAccount:setLastTypedAccount}},children);}export var useCurrencyPairState=function useCurrencyPairState(){var context=useContext(CurrencyPairContext);return context;};function getDefaultTokens(env,search){var defaultBase=\"BTC\";var defaultQuote=\"USDT\";console.log(search);var nameToToken=PopularTokens[env].reduce(function(map,item){map.set(item.tokenSymbol,item);return map;},new Map());if(search){var urlParams=new URLSearchParams(search);var pair=urlParams.get(\"pair\");if(pair){var items=pair.split(\"-\");if(items.length>1){if(nameToToken.has(items[0])){defaultBase=items[0];}if(nameToToken.has(items[1])){defaultQuote=items[1];}}}}return{defaultBase:defaultBase,defaultQuote:defaultQuote};}","map":{"version":3,"sources":["/home/fs/srmswap/srmswap/srmswap.github.io/src/utils/currencyPair.tsx"],"names":["React","useCallback","useContext","useEffect","useState","calculateDependentAmount","usePoolForBasket","useMint","useAccountByMint","useConnection","useConnectionConfig","convert","PopularTokens","useHistory","useLocation","CurrencyPairContext","createContext","CurrencyPairProvider","children","connection","env","amountA","setAmountA","amountB","setAmountB","history","location","mintAddressA","setMintAddressA","mintAddressB","setMintAddressB","lastTypedAccount","setLastTypedAccount","accountA","accountB","mintA","mintB","pool","base","find","t","mintAddress","tokenSymbol","quote","push","pathname","search","getDefaultTokens","defaultBase","defaultQuote","calculateDependent","independent","setDependent","amount","parseFloat","result","undefined","Number","isFinite","toFixed","convertAmount","mint","Math","pow","decimals","A","account","setAmount","setMint","sufficientBalance","B","useCurrencyPairState","context","console","log","nameToToken","reduce","map","item","set","Map","urlParams","URLSearchParams","pair","get","items","split","length","has"],"mappings":"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","sourcesContent":["import React, { useCallback, useContext, useEffect, useState } from \"react\";\nimport { calculateDependentAmount, usePoolForBasket } from \"./pools\";\nimport { useMint, useAccountByMint } from \"./accounts\";\nimport { MintInfo } from \"@solana/spl-token\";\nimport { ENV, useConnection, useConnectionConfig } from \"./connection\";\nimport { TokenAccount } from \"../models\";\nimport { convert } from \"./utils\";\nimport PopularTokens from \"../utils/token-list.json\";\nimport { useHistory, useLocation } from \"react-router-dom\";\n\nexport interface CurrencyContextState {\n  mintAddress: string;\n  account?: TokenAccount;\n  mint?: MintInfo;\n  amount: string;\n  setAmount: (val: string) => void;\n  setMint: (mintAddress: string) => void;\n  convertAmount: () => number;\n  sufficientBalance: () => boolean;\n}\n\nexport interface CurrencyPairContextState {\n  A: CurrencyContextState;\n  B: CurrencyContextState;\n  setLastTypedAccount: (mintAddress: string) => void;\n}\n\nconst CurrencyPairContext = React.createContext<CurrencyPairContextState | null>(\n  null\n);\n\nexport function CurrencyPairProvider({ children = null as any }) {\n  const connection = useConnection();\n  const { env } = useConnectionConfig();\n  const [amountA, setAmountA] = useState(\"\");\n  const [amountB, setAmountB] = useState(\"\");\n  const history = useHistory();\n  const location = useLocation();\n  const [mintAddressA, setMintAddressA] = useState(\"\");\n  const [mintAddressB, setMintAddressB] = useState(\"\");\n  const [lastTypedAccount, setLastTypedAccount] = useState(\"\");\n  const accountA = useAccountByMint(mintAddressA);\n  const accountB = useAccountByMint(mintAddressB);\n  const mintA = useMint(mintAddressA);\n  const mintB = useMint(mintAddressB);\n  const pool = usePoolForBasket([mintAddressA, mintAddressB]);\n\n  // updates browser history on token changes\n  useEffect(() => {\n    // set history\n    const base = PopularTokens[env].find((t) => t.mintAddress === mintAddressA)\n      ?.tokenSymbol;\n    const quote = PopularTokens[env].find((t) => t.mintAddress === mintAddressB)\n      ?.tokenSymbol;\n\n    if (base && quote) {\n      history.push({\n        pathname: \"/\",\n        search: `?pair=${base}-${quote}`,\n      });\n    } else {\n      if (mintAddressA && mintAddressB) {\n        history.push({\n          pathname: \"/\",\n          search: ``,\n        });\n      } else {\n        history.push({});\n      }\n    }\n  }, [mintAddressA, mintAddressB]);\n\n  // Updates tokens on location change\n  useEffect(() => {\n    if (!location.search && mintAddressA && mintAddressB) {\n      return;\n    }\n\n    let { defaultBase, defaultQuote } = getDefaultTokens(env, location.search);\n    setMintAddressA(\n      PopularTokens[env].find((t) => t.tokenSymbol === defaultBase)\n        ?.mintAddress || \"\"\n    );\n    setMintAddressB(\n      PopularTokens[env].find((t) => t.tokenSymbol === defaultQuote)\n        ?.mintAddress || \"\"\n    );\n  }, [location, location.search, setMintAddressA, setMintAddressB]);\n\n  const calculateDependent = useCallback(async () => {\n    if (pool && mintAddressA && mintAddressB) {\n      let setDependent;\n      let amount;\n      let independent;\n      if (lastTypedAccount === mintAddressA) {\n        independent = mintAddressA;\n        setDependent = setAmountB;\n        amount = parseFloat(amountA);\n      } else {\n        independent = mintAddressB;\n        setDependent = setAmountA;\n        amount = parseFloat(amountB);\n      }\n\n      const result = await calculateDependentAmount(\n        connection,\n        independent,\n        amount,\n        pool\n      );\n      if (result !== undefined && Number.isFinite(result)) {\n        setDependent(result.toFixed(2));\n      } else {\n        setDependent(\"\");\n      }\n    }\n  }, [\n    pool,\n    mintAddressA,\n    mintAddressB,\n    setAmountA,\n    setAmountB,\n    amountA,\n    amountB,\n    connection,\n    lastTypedAccount,\n  ]);\n\n  useEffect(() => {\n    calculateDependent();\n  }, [amountB, amountA, lastTypedAccount, calculateDependent]);\n\n  const convertAmount = (amount: string, mint?: MintInfo) => {\n    return parseFloat(amount) * Math.pow(10, mint?.decimals || 0);\n  };\n\n  return (\n    <CurrencyPairContext.Provider\n      value={{\n        A: {\n          mintAddress: mintAddressA,\n          account: accountA,\n          mint: mintA,\n          amount: amountA,\n          setAmount: setAmountA,\n          setMint: setMintAddressA,\n          convertAmount: () => convertAmount(amountA, mintA),\n          sufficientBalance: () =>\n            accountA !== undefined &&\n            convert(accountA, mintA) >= parseFloat(amountA),\n        },\n        B: {\n          mintAddress: mintAddressB,\n          account: accountB,\n          mint: mintB,\n          amount: amountB,\n          setAmount: setAmountB,\n          setMint: setMintAddressB,\n          convertAmount: () => convertAmount(amountB, mintB),\n          sufficientBalance: () =>\n            accountB !== undefined &&\n            convert(accountB, mintB) >= parseFloat(amountB),\n        },\n        setLastTypedAccount,\n      }}\n    >\n      {children}\n    </CurrencyPairContext.Provider>\n  );\n}\n\nexport const useCurrencyPairState = () => {\n  const context = useContext(CurrencyPairContext);\n  return context as CurrencyPairContextState;\n};\nfunction getDefaultTokens(env: ENV, search: string) {\n  let defaultBase = \"BTC\";\n  let defaultQuote = \"USDT\";\n\n  console.log(search);\n\n  const nameToToken = (PopularTokens[env] as any[]).reduce((map, item) => {\n    map.set(item.tokenSymbol, item);\n    return map;\n  }, new Map<string, any>());\n\n  if (search) {\n    const urlParams = new URLSearchParams(search);\n    const pair = urlParams.get(\"pair\");\n    if (pair) {\n      let items = pair.split(\"-\");\n\n      if (items.length > 1) {\n        if (nameToToken.has(items[0])) {\n          defaultBase = items[0];\n        }\n\n        if (nameToToken.has(items[1])) {\n          defaultQuote = items[1];\n        }\n      }\n    }\n  }\n  return { defaultBase, defaultQuote };\n}\n"]},"metadata":{},"sourceType":"module"}
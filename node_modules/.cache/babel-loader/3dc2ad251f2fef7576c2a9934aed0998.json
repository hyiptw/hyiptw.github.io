{"ast":null,"code":"import _toConsumableArray from\"/home/fs/srmswap/oyster-swap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import React from\"react\";import{Card,Select}from\"antd\";import{NumericInput}from\"../numericInput\";import{getPoolName,getTokenName,isKnownMint}from\"../../utils/utils\";import{useUserAccounts,useMint,useCachedPool}from\"../../utils/accounts\";import\"./styles.less\";import{useConnectionConfig}from\"../../utils/connection\";import{PoolIcon,TokenIcon}from\"../tokenIcon\";import PopularTokens from\"../../utils/token-list.json\";var Option=Select.Option;export var CurrencyInput=function CurrencyInput(props){var _useUserAccounts=useUserAccounts(),userAccounts=_useUserAccounts.userAccounts;var _useCachedPool=useCachedPool(),pools=_useCachedPool.pools;var mint=useMint(props.mint);var _useConnectionConfig=useConnectionConfig(),env=_useConnectionConfig.env;var tokens=PopularTokens[env];var renderPopularTokens=tokens.map(function(item){return/*#__PURE__*/React.createElement(Option,{key:item.mintAddress,value:item.mintAddress,title:item.mintAddress},/*#__PURE__*/React.createElement(\"div\",{key:item.mintAddress,style:{display:\"flex\",alignItems:\"center\"}},/*#__PURE__*/React.createElement(TokenIcon,{mintAddress:item.mintAddress}),item.tokenSymbol));});// TODO: expand nested pool names ...?\n// group accounts by mint and use one with biggest balance\nvar grouppedUserAccounts=userAccounts.sort(function(a,b){return b.info.amount.toNumber()-a.info.amount.toNumber();}).reduce(function(map,acc){var mint=acc.info.mint.toBase58();if(isKnownMint(env,mint)){return map;}var pool=pools.find(function(p){return p&&p.pubkeys.mint.toBase58()===mint;});map.set(mint,(map.get(mint)||[]).concat([{account:acc,pool:pool}]));return map;},new Map());// TODO: group multple accounts of same time and select one with max amount\nvar renderAdditionalTokens=_toConsumableArray(grouppedUserAccounts.keys()).map(function(mint){var list=grouppedUserAccounts.get(mint);if(!list||list.length<=0){return undefined;}var account=list[0];if(account.account.info.amount.eqn(0)){return undefined;}var name;var icon;if(account.pool){name=getPoolName(env,account.pool);var sorted=account.pool.pubkeys.holdingMints.map(function(a){return a.toBase58();}).sort();icon=/*#__PURE__*/React.createElement(PoolIcon,{mintA:sorted[0],mintB:sorted[1]});}else{name=getTokenName(env,mint);icon=/*#__PURE__*/React.createElement(TokenIcon,{mintAddress:mint});}return/*#__PURE__*/React.createElement(Option,{key:account.account.pubkey.toBase58(),value:mint,title:mint},/*#__PURE__*/React.createElement(\"div\",{key:mint,style:{display:\"flex\",alignItems:\"center\"}},icon,name));});var userUiBalance=function userUiBalance(){var currentAccount=userAccounts===null||userAccounts===void 0?void 0:userAccounts.find(function(a){return a.info.mint.toBase58()===props.mint;});if(currentAccount&&mint){return currentAccount.info.amount.toNumber()/Math.pow(10,mint.decimals);}return 0;};return/*#__PURE__*/React.createElement(Card,{className:\"ccy-input\",style:{borderRadius:20,margin:15},bodyStyle:{padding:0}},/*#__PURE__*/React.createElement(\"div\",{className:\"ccy-input-header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"ccy-input-header-left\"},props.title),/*#__PURE__*/React.createElement(\"div\",{className:\"ccy-input-header-right\",onClick:function onClick(e){return props.onInputChange&&props.onInputChange(userUiBalance());}},\"Balance: \",userUiBalance().toFixed(6))),/*#__PURE__*/React.createElement(\"div\",{className:\"ccy-input-header\",style:{padding:\"0px 10px 5px 7px\"}},/*#__PURE__*/React.createElement(NumericInput,{value:props.amount,onChange:function onChange(val){if(props.onInputChange){props.onInputChange(val);}},style:{fontSize:20,boxShadow:\"none\",borderColor:\"transparent\",outline:\"transpaernt\"},placeholder:\"0.00\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"ccy-input-header-right\",style:{display:\"felx\"}},/*#__PURE__*/React.createElement(Select,{size:\"large\",style:{minWidth:80},placeholder:\"CCY\",value:props.mint,dropdownMatchSelectWidth:true,dropdownStyle:{minWidth:200},onChange:function onChange(item){if(props.onMintChange){props.onMintChange(item);}}},[].concat(_toConsumableArray(renderPopularTokens),_toConsumableArray(renderAdditionalTokens))))));};","map":null,"metadata":{},"sourceType":"module"}